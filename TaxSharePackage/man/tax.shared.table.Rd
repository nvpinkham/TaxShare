% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Functions.25.04.18.R
\name{tax.shared.table}
\alias{tax.shared.table}
\title{Compare Shared and Unique Taxa Between Groups}
\usage{
tax.shared.table(
  otu,
  var,
  group1,
  group2,
  tax.level,
  PresAbs = F,
  log = T,
  taxa2include,
  round.to = 3,
  add.n = T
)
}
\arguments{
\item{otu}{A matrix or data frame of OTU abundances (samples in rows, OTUs in columns).}

\item{var}{A vector indicating group membership for each sample (must match rows of \code{otu}).}

\item{group1}{A value from \code{var} representing the first group.}

\item{group2}{A value from \code{var} representing the second group.}

\item{tax.level}{A vector assigning taxonomic classification (e.g., family) to each OTU column.}

\item{PresAbs}{Logical; if TRUE, convert abundances to presence/absence (binary) data. Default is FALSE.}

\item{log}{Logical; if TRUE, apply log10(x + 1) transformation to final output. Default is TRUE.}

\item{taxa2include}{Optional vector of taxa names to include in the final output. If provided, will subset and order columns.}

\item{round.to}{Number of decimal places for rounding adjusted p-values. Default is 3.}

\item{add.n}{Logical; if TRUE, adds the number of OTUs per taxon to column names. Default is TRUE.}
}
\value{
A matrix with 4 rows (unique and shared taxa for each group) and columns representing taxa,
possibly with attached p-values and OTU counts. The matrix is log-transformed if \code{log = TRUE}.
}
\description{
This function compares OTU abundances between two groups (e.g., species, treatments)
and summarizes shared and unique taxa at a given taxonomic level. It can apply presence-absence
filtering and log transformation, and optionally include p-values for group differences.
}
\details{
The function aggregates OTU counts to the specified taxonomic level, identifies taxa unique to each group,
and computes Wilcoxon tests for statistical differences in abundance. Shared and unique taxa are tested separately,
and FDR-adjusted p-values are included in column labels.
}
